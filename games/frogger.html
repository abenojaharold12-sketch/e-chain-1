<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Frogger Game | E-Chain</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #cce6ff;
      margin: 0;
    }
    canvas {
      border: 2px solid #333;
      background-color: #87CEFA; /* water background */
      display: block;
      margin-top: 20px;
    }
    #score {
      font-size: 20px;
      font-weight: bold;
      margin-top: 10px;
    }
    button.restart {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background-color: #ff4d4d;
      color: white;
    }
    .legend {
      margin-top: 10px;
    }
    .legend span {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-right: 5px;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <h1>Frogger | E-Chain Edition</h1>
  <canvas id="gameCanvas" width="400" height="500"></canvas>
  <div id="score">Score: 0</div>

  <!-- Legend -->
  <div class="legend">
    <span style="background-color: green;"></span> Player
    <span style="background-color: red;"></span> Car
    <span style="background-color: brown;"></span> Log
    <span style="background-color: #87CEFA; border:1px solid #333;"></span> Water
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const laneHeight = 50;

    let player = { x: 180, y: 450, width: 40, height: 40, color: "green" };
    let cars = [];
    let logs = [];
    let score = 0;
    let gameOver = false;

    // Generate cars and logs
    function spawnObjects() {
      cars = [];
      logs = [];

      for (let i = 1; i <= 3; i++) {
        // Cars
        const speed = 2 + i * 0.5;
        const car = { x: Math.random() * canvas.width, y: i * laneHeight, width: 40, height: 40, color: "red", speed };
        cars.push(car);
      }

      for (let i = 1; i <= 2; i++) {
        // Logs
        const logSpeed = 1 + i;
        const log = { x: Math.random() * canvas.width, y: (i+3) * laneHeight, width: 80, height: 40, color: "brown", speed: logSpeed };
        logs.push(log);
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw water/lane lines
      for (let i = 0; i <= 10; i++) {
        if (i >= 4 && i <= 6) {
          ctx.fillStyle = "#87CEFA"; // water
        } else if (i >= 1 && i <=3) {
          ctx.fillStyle = "#ccc"; // road
        } else {
          ctx.fillStyle = "#90EE90"; // safe grass
        }
        ctx.fillRect(0, i * laneHeight, canvas.width, laneHeight);
      }

      // Draw player
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x, player.y, player.width, player.height);

      // Draw cars
      cars.forEach(car => {
        ctx.fillStyle = car.color;
        ctx.fillRect(car.x, car.y, car.width, car.height);
      });

      // Draw logs
      logs.forEach(log => {
        ctx.fillStyle = log.color;
        ctx.fillRect(log.x, log.y, log.width, log.height);
      });

      // Draw score
      document.getElementById("score").innerText = "Score: " + score;
    }

    function updateObjects() {
      cars.forEach(car => {
        car.x += car.speed;
        if (car.x > canvas.width) car.x = -car.width;
      });

      logs.forEach(log => {
        log.x -= log.speed;
        if (log.x + log.width < 0) log.x = canvas.width;
      });
    }

    function checkCollision() {
      // Cars
      for (let car of cars) {
        if (
          player.x < car.x + car.width &&
          player.x + player.width > car.x &&
          player.y < car.y + car.height &&
          player.y + player.height > car.y
        ) {
          gameOver = true;
          showRestartButton();
        }
      }

      // Water: if in water lanes (4-6) without a log
      if (player.y >= 4 * laneHeight && player.y <= 6 * laneHeight) {
        let onLog = false;
        for (let log of logs) {
          if (
            player.x + player.width > log.x &&
            player.x < log.x + log.width &&
            player.y + player.height > log.y &&
            player.y < log.y + log.height
          ) {
            onLog = true;
            player.x -= log.speed; // player moves with log
          }
        }
        if (!onLog) {
          gameOver = true;
          showRestartButton();
        }
      }

      // Win
      if (player.y < laneHeight) {
        score += 10;
        moveScreen();
        player.y = canvas.height - player.height - laneHeight;
      }
    }

    function moveScreen() {
      cars.forEach(car => car.y += laneHeight / 2);
      logs.forEach(log => log.y += laneHeight / 2);
    }

    document.addEventListener("keydown", (e) => {
      if (gameOver) return;
      const moveAmount = laneHeight;
      if (e.key === "ArrowUp") player.y -= moveAmount;
      if (e.key === "ArrowDown") player.y += moveAmount;
      if (e.key === "ArrowLeft") player.x -= moveAmount;
      if (e.key === "ArrowRight") player.x += moveAmount;

      // Stay inside canvas
      if (player.x < 0) player.x = 0;
      if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
      if (player.y < 0) player.y = 0;
      if (player.y + player.height > canvas.height) player.y = canvas.height - player.height;
    });

    function showRestartButton() {
      const restartBtn = document.createElement("button");
      restartBtn.textContent = "Restart";
      restartBtn.classList.add("restart");
      document.body.appendChild(restartBtn);

      restartBtn.addEventListener("click", () => {
        restartBtn.remove();
        restartGame();
      });
    }

    function restartGame() {
      player.x = 180;
      player.y = 450;
      score = 0;
      gameOver = false;
      spawnObjects();
      gameLoop();
    }

    function gameLoop() {
      if (!gameOver) {
        updateObjects();
        checkCollision();
        draw();
        requestAnimationFrame(gameLoop);
      }
    }

    // Start
    spawnObjects();
    gameLoop();
  </script>
</body>
</html>
